<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <title>众创数字资产综合运营管理平台</title>
	<link rel="stylesheet" href="../../layui/css/layui.css"/>
	<link rel="stylesheet" href="../../css/admin.css"/>
</head>
<body>
	<div class="container">
		<div class="content-search">
			<form class="layui-form layui-form-pane" action="">
				<div class="layui-inline">
					<label class="layui-form-label">订单编号</label>
					<div class="layui-input-block">
						<input name="date" placeholder="请输入订单编号" autocomplete="off" class="layui-input" type="text"/>
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">订单状态</label>
					<div class="layui-input-inline">
						<select name="city" lay-verify="">
						  <option value="0">请选择</option>
						  <option value="1">待发货</option>
						  <option value="2">待签收</option>
						  <option value="3">已签收</option>
						</select>   
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">变更时间</label>
					<div class="layui-input-inline">
						<input class="layui-input layui-date" placeholder="变更时间" id="end">
					</div>
				</div>
				<div class="layui-inline"><button class="layui-btn" lay-submit="">查询</button></div>
			</form>
		</div>

		<div class="table-list roll-x">
			<table class="layui-table" lay-skin="line">
			  <thead>
			    <tr>
			      <th>订单编号</th>
			      <th>商品名称</th>
			      <th>成交金额</th>
			      <th>收货人</th>
					<th>手机号码</th>
					<th>邮箱</th>
			      <th>订单状态</th>
			      <th>变更时间</th>
			      <th>操作</th>
			    </tr> 
			  </thead>
			  <tbody id="order-form-tbody">

			  </tbody>
			</table>   
		</div>
	</div>
	<div id="table-pages" style="text-align:center"></div>
	<script type="text/javascript" src="../../layui/layui.js"></script>
	<script type="text/javascript" src="../../js/jquery-1.8.3.min.js"></script>
    <script>
		$(function () {
			//订单数据加载
			$.ajax({
			    //请求方式
			    type:'GET',
			    //发送请求的地址
			    url:'/guliOrder/orderAll?id='+1,
			    //服务器返回的数据类型
			    dataType:'json',
			    //发送到服务器的数据，对象必须为key/value的格式，jquery会自动转换为字符串格式
			    // data:{name:xxx,age:xxx},
			    success:function(data){
			        //请求成功函数内容
					// console.log(data);
					$("#order-form-tbody").find("tr").remove();
					//判断信息是否为空
					if(data==null){
						layui.use('layer', function(){
							var layer = layui.layer;
							layer.open({
								area:['60%', '60%'],
								type:0,
								title: '数据信息提示'
								,content: '你的显示数据为空!'
							});
						});
					}else{
						for (var i = 0;i < data.length;i++){
							var order = data[i];
							var tr = "<tr>\n" +
									"<td><a href=\"javascript:;\" class=\"a1\">"+order.orderNumber+"</a></td>\n" +
									"<td>"+order.orderTradeName+"</td>\n" +
									"<td><span class=\"price\">"+order.orderTradePrice+"</span></td>\n" +
									"<td>"+order.userName+"</td>\n" +
									"<td>"+order.userPhone+"</td>\n" +
									"<td>"+order.userEmail+"</td>\n" +
									"<td><span class=\"red\">"+order.orderStatusStr+"</span></td>\n" +
									"<td>"+order.orderUpdateTime+"</td>\n" +
									"<td>\n" +
									"<input type='hidden' value='"+order.orderNumber+"'>" +
									"<button class=\"layui-btn layui-btn-danger layui-btn-small a4\">订单详情</button>\n" +
									"</td>\n" +
									"</tr>";
							$("#order-form-tbody").append(tr);
						}
					}
			    },
			    error:function(jqXHR){
			        //请求失败函数内容
			        console.log(jqXHR);
					layui.use('layer', function(){
						var layer = layui.layer;
						layer.open({
							area:['60%', '60%'],
							type:0,
							title: '错误信息提示'
							,content: '服务错误,代码为999999,请联系管理员!'
						});
					});
			    }

			});
		});

		layui.use(['jquery', 'laydate','form','layer','laypage'], function(){
			var $ = layui.jquery,
			    laydate = layui.laydate,
			    layer = layui.layer,
			    laypage = layui.laypage;

			// 分页
			 laypage({
			    cont: 'table-pages'
			    ,pages: 100
			    ,skip: true
			  });

            // 开始时间及截止时间
            var start = {
			   choose: function(datas){
			      end.min = datas; //开始日选好后，重置结束日的最小日期
			      end.start = datas //将结束日的初始值设定为开始日
			    }
			  };

			  var end = {
			    choose: function(datas){
			      start.max = datas; //结束日选好后，重置开始日的最大日期
			    }
			  };

			$('#start').click(function(){
				start.elem = this;
    			laydate(start);
			});

			$('#end').click(function(){
				end.elem = this
    			laydate(end);
			});


			//待发货详情
			$(document).on("click", ".a1", function() {
				layer.open({
			      type:2
			      ,area:['80%', '90%']
			      ,title:"订单详情"
				  ,content: '平台待发货详情.html'
				});
			});

			$(document).on("click", ".a5", function() {
				layer.open({
			      type:2
			      ,area:['80%', '90%']
			      ,title:"订单详情"
				  ,content: '第三方待发货详情.html'
				});
			});

			// 待签收，已签收详情
			$(document).on("click", ".a7", function() {
				layer.open({
			      type:2
			      ,area:['80%', '90%']
			      ,title:"订单详情"
				  ,content: '平台已发货详情.html'
				});
			});
			$(document).on("click", ".a8", function() {
				layer.open({
			      type:2
			      ,area:['80%', '90%']
			      ,title:"订单详情"
				  ,content: '第三方已发货详情.html'
				});
			});

			// 会员详情
			$(document).on("click", ".a2", function() {
			    layer.open({
			      type:2
			      ,area:['50%', '70%']
			      ,title:"会员详情"
				  ,content: '会员详情.html'
				});
			});
			// 平台发货
			$(document).on("click", ".a3", function() {
			    layer.open({
			      type:2
			      ,area:['50%', '50%']
			      ,title:"平台发货"
				  ,content: '平台发货.html'
				});
			});
			// 平台替第三方发货
			// $(document).on("click", ".a6", function() {
			// 	layer.open({
			//       title:"第三方发货提醒"
			// 	  ,content: '该订单为第三方（XXX公司）订单您确认由平台发货吗?'
			// 	  ,btn: ['取消', '确认']
			// 	  ,yes: function(index, layero){
			// 	       layer.closeAll();
			// 	  }
			// 	  ,btn2: function(index, layero){
			// 	  	layer.open({
			// 	  		type:2
			//       		,area:['50%', '70%']
			// 	      	,title:"平台发货"
			// 	  		,content: '订单详情.html'
			// 		});
			// 	  }
			// 	});
            //
			// });

			// 取消订单
			$(document).on("click", ".a4", function() {

			    layer.open({
			      type:2
				  ,area:['50%', '70%']
			      ,title:"订单详情"
				  ,content: 'pages/订单详情.html'
				});
			});

		});
	</script>
</body>
</html>